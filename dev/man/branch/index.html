<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Network Equations · JuliaGrid</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/style.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="JuliaGrid logo"/></a><div class="docs-package-name"><span class="docs-autofit">JuliaGrid</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../input/">Input Data</a></li><li><a class="tocitem" href="../flow/">Power Flow</a></li><li><a class="tocitem" href="../estimation/">State Estimation</a></li><li><a class="tocitem" href="../generator/">Measurement Generator</a></li><li><span class="tocitem">Theoretical Background</span><ul><li class="is-active"><a class="tocitem" href>Network Equations</a><ul class="internal"><li><a class="tocitem" href="#branchmodel-1"><span>Branch Model</span></a></li><li><a class="tocitem" href="#injectionnodal-1"><span>Nodal Admittance Matrix</span></a></li><li><a class="tocitem" href="#injectionpower-1"><span>Injection Power</span></a></li><li><a class="tocitem" href="#refsbranch-1"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../tbflow/">Power Flow</a></li><li><a class="tocitem" href="../tbestimate/">State Estimation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theoretical Background</a></li><li class="is-active"><a href>Network Equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Network Equations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mcosovic/JuliaGrid.jl/blob/master/docs/src/man/branch.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="networkequationpage-1"><a class="docs-heading-anchor" href="#networkequationpage-1">Network Equations</a><a class="docs-heading-anchor-permalink" href="#networkequationpage-1" title="Permalink"></a></h1><p>Network equations obtained using the unified branch model and defined below represent the basic setup used for the power system analysis. The power system network topology is usually described by the bus/branch model, where branches of the network are defined using the two-port <span>$\pi$</span>-model. The bus/branch model can be represented using a graph <span>$\mathcal{G} =(\mathcal{H},\mathcal{E})$</span>, where the set of nodes <span>$\mathcal{H} = \{1,\dots,n  \}$</span> represents the set of buses, while the set of edges <span>$\mathcal{E} \subseteq \mathcal{H} \times \mathcal{H}$</span> represents the set of branches of the power network, shown in Figure 1.</p><img src="../../assets/bus_branch.png" class="center"/>
<figcaption>Figure 1: An example of the power system bus/branch model.</figcaption><hr/><h2 id="branchmodel-1"><a class="docs-heading-anchor" href="#branchmodel-1">Branch Model</a><a class="docs-heading-anchor-permalink" href="#branchmodel-1" title="Permalink"></a></h2><p>The equivalent unified <span>$\pi$</span>-model for a branch, shown in Figure 2, is sufficient to describe all main equations related to the power system.</p><img src="../../assets/pi_model.png" class="center"/>
<figcaption>Figure 2: The equivalent branch model, where transformer is located at "from bus end" of the branch.</figcaption>
&nbsp;<p>In Figure 2, <span>$\{i,j\} \in \mathcal{H}$</span> denotes buses, where, in power networks the bus represents elements such as a generator, load, substation, etc. The branch series admittance <span>$y_{ij}$</span> is inversely proportional to the branch series impedance <span>$z_{ij}$</span>:  </p><div>\[    y_{ij} = \frac{1}{z_{ij}} =
    \frac{1}{{r_{ij}} + \text{j}x_{ij}} =
    \frac{r_{ij}}{r_{ij}^2 + x_{ij}^2} - \text{j}\frac{x_{ij}}{r_{ij}^2 + x_{ij}^2} = g_{ij} + \text{j}b_{ij},\]</div><p>where <span>$r_{ij}$</span> is a resistance, <span>$x_{ij}$</span> is a reactance, <span>$g_{ij}$</span> is a conductance and <span>$b_{ij}$</span> is a susceptance of the branch. We denote a half of the total branch shunt admittance (i.e., charging admittance) as <span>$y_{\text{s}ij}$</span> and <span>$y_{\text{s}ji}$</span>, where it can be written:</p><div>\[y_{\text{s}ij} = y_{\text{s}ji} = \text{j} b_{\text{s}i} = \text{j} b_{\text{s}j}.
\]</div><p>The transformer complex ratio <span>$\alpha_{ij}$</span> is defined:</p><div>\[    \alpha_{ij} = \cfrac{1}{\tau_{ij}}e^{-\text{j}\phi_{ij}},\]</div><p>where <span>$\tau_{ij}$</span> is the transformer tap ratio magnitude, while <span>$\phi_{ij}$</span> is the transformer phase shift angle, always located &quot;from bus end&quot; of the branch.</p><p>Using Kirchhoff&#39;s circuit laws, <strong>the unified branch model</strong> can be described by complex expressions:</p><div>\[  \begin{bmatrix}
    \bar{I}_{ij} \\ \bar{I}_{ji}
  \end{bmatrix} =
  \begin{bmatrix}
    \cfrac{1}{\tau_{ij}^2}({y}_{ij} + y_{\text{s}ij}) &amp; -\alpha_{ij}^*{y}_{ij}\\
    -\alpha_{ij}{y}_{ij} &amp; {y}_{ij} + y_{\text{s}ij}
  \end{bmatrix}  
  \begin{bmatrix}
    \bar{V}_{i} \\ \bar{V}_{j}
  \end{bmatrix}.    \]</div><p>Each branch <span>$(i,j) \in \mathcal{E}$</span> can be described with four parameters <span>$C_{ij}$</span>, <span>$D_{ij}$</span>, <span>$E_{ij}$</span> and <span>$F_{ij}$</span>, where the unified branch model is:</p><div>\[  \begin{bmatrix}
    \bar{I}_{ij} \\ \bar{I}_{ji}
  \end{bmatrix} =
  \begin{bmatrix}
    C_{ij} &amp; D_{ij}\\
    E_{ij} &amp; F_{ij}
  \end{bmatrix}  
  \begin{bmatrix}
    \bar{V}_{i} \\ \bar{V}_{j}
  \end{bmatrix}.    \]</div><p>Consequently, if <span>$\tau_{ij} = 1$</span> and <span>$\phi_{ij} = 0$</span> the model describes the line. In-phase transformers are defined if <span>$\phi_{ij} = 0$</span> and <span>$y_{\text{s}ij} = 0$</span>, while phase-shifting transformers are obtained if <span>$y_{\text{s}ij} = 0$</span>.</p><hr/><h2 id="injectionnodal-1"><a class="docs-heading-anchor" href="#injectionnodal-1">Nodal Admittance Matrix</a><a class="docs-heading-anchor-permalink" href="#injectionnodal-1" title="Permalink"></a></h2><p>Let us consider an example, given in Figure 3, that will allow us an easy transition to the general case. We observe system with three buses and two branches, where the bus <span>$k$</span> is incident to the shunt element.</p><img src="../../assets/pi_model_example.png" class="center"/>
<figcaption>Figure 3: The example with three buses and two branches.</figcaption>
&nbsp;<p>JuliaGrid uses the input data where the bus incident to the transformer is always located at &quot;from bus end&quot;, and accordingly, we denote other elements related to branches, as given in Table.</p><table><tr><th style="text-align: center">From Bus</th><th style="text-align: center">To Bus</th><th style="text-align: center">Admittance</th><th style="text-align: center">Shunt Admittance</th><th style="text-align: center">Transformer Ratio</th></tr><tr><td style="text-align: center"><span>$p$</span></td><td style="text-align: center"><span>$k$</span></td><td style="text-align: center"><span>$y_{pk}$</span></td><td style="text-align: center"><span>$y_{\text{s}pk}$</span></td><td style="text-align: center"><span>$\alpha_{pk}$</span></td></tr><tr><td style="text-align: center"><span>$k$</span></td><td style="text-align: center"><span>$q$</span></td><td style="text-align: center"><span>$y_{kq}$</span></td><td style="text-align: center"><span>$y_{\text{s}kq}$</span></td><td style="text-align: center"><span>$\alpha_{kq}$</span></td></tr></table><p>Before we proceed further, it would be helpful to observe sets related to the system that we use in the rest of this part:</p><ul><li>set of buses: <span>$\mathcal{H} = \{p,k,q\}$</span>;</li><li>set of branches: <span>$\mathcal{E} = \{(p,k), (k,q)\}$</span>.</li></ul><p>According to the <a href="#branchmodel-1">unified branch model</a> each branch is described using the system of equations as follows:</p><div>\[  \begin{bmatrix}
    \bar{I}_{pk} \\ \bar{I}_{kp}
  \end{bmatrix} =
  \begin{bmatrix}
    C_{pk} &amp; D_{pk}\\
    E_{pk} &amp; F_{pk}
  \end{bmatrix}  
  \begin{bmatrix}
    \bar{V}_{p} \\ \bar{V}_{k}
  \end{bmatrix}   \]</div><div>\[  \begin{bmatrix}
    \bar{I}_{kq} \\ \bar{I}_{qk}
  \end{bmatrix} =
  \begin{bmatrix}
    C_{kq} &amp; D_{kq}\\
    E_{kq} &amp; F_{kq}
  \end{bmatrix}  
  \begin{bmatrix}
    \bar{V}_{k} \\ \bar{V}_{q}
  \end{bmatrix}.    \]</div><p>The injection complex currents into buses are:</p><div>\[  \begin{aligned}
    \bar{I}_{p} &amp;= \bar{I}_{pk} = C_{pk} \bar{V}_{p} + D_{pk} \bar{V}_{k} \\
    \bar{I}_{k} &amp;= \bar{I}_{kp} + \bar{I}_{kq} - \bar{I}_{\text{sh}k} = E_{pk} \bar{V}_{p} + F_{pk} \bar{V}_{k} + C_{kq} \bar{V}_{k} + D_{kq} \bar{V}_{q} + {y}_{\text{sh}k} \bar{V}_k \\
    \bar{I}_{q} &amp;= \bar{I}_{qk} = E_{kq} \bar{V}_{k} + F_{kq} \bar{V}_{q},
  \end{aligned}\]</div><p>The system of equations can be written in the matrix form:</p><div>\[  \begin{bmatrix}
    \bar{I}_{p} \\ \bar{I}_{k} \\ \bar{I}_{q}
  \end{bmatrix} =
  \begin{bmatrix}
    C_{pk} &amp; D_{pk} &amp; 0 \\
    E_{pk} &amp; C_{kq} + F_{pk} + {y}_{\text{sh}k}  &amp; D_{kq} \\
    0 &amp; E_{kq} &amp; F_{kq}
  \end{bmatrix}
  \begin{bmatrix}
    \bar{V}_{p} \\ \bar{V}_{k} \\ \bar{V}_{q}
  \end{bmatrix}.\]</div><p>Next, the system of equations for buses <span>$i=1, \dots, n$</span> can be written in the matrix form:</p><div>\[  \mathbf {\bar {I}} = \mathbf{Y} \mathbf {\bar {V}},\]</div><p>where:</p><ul><li><span>$\mathbf {\bar {I}} \in \mathbb{C}^{n}$</span> is the vector of injection complex currents with elements <span>$\bar{I}_i,\;i=1,\dots,n$</span>;</li><li><span>$\mathbf {\bar {V}} \in \mathbb{C}^{n}$</span> is the vector of bus complex voltages with elements <span>$\bar{V}_i,\;i=1,\dots,n$</span>;</li><li><span>$\mathbf{Y} = \mathbf{G} + \text{j}\mathbf{B} \in \mathbb{C}^{n \times n}$</span> is the <strong>bus or nodal admittance matrix</strong>, where:<ul><li>the diagonal elements are equal to:<div>\[Y_{ii} = G_{ii} + \text{j}B_{ii} =
\sum\limits_{e \in \mathcal{E}, \; e(1) = i} C_{e} + \sum\limits_{e \in \mathcal{E}, \; e(2) = i} F_{e} + {y}_{\text{sh}i},  \;\;\; i \in \mathcal{H},\]</div></li><li>the strictly upper triangular part contains elements equal to:<div>\[Y_{ij} = G_{ij} + \text{j}B_{ij} = D_{e}, \;\;\;  e \in \mathcal{E},\;  i = e(1),\;  j = e(2),\]</div></li><li>the strictly lower triangular part contains elements equal to:<div>\[Y_{ij} = G_{ij} + \text{j}B_{ij} = E_{e}, \;\;\;  e \in \mathcal{E},\;  i = e(2),\;  j = e(1).\]</div></li></ul></li></ul><p>When a branch is not incident (or adjacent) to a bus the corresponding element in the nodal admittance matrix <span>$\mathbf{Y}$</span> is equal to zero. The nodal admittance matrix <span>$\mathbf{Y}$</span> is a sparse matrix (i.e., a small number of elements are non-zeros) for real-world power systems. Although it is often assumed that the matrix <span>$\mathbf{Y}$</span> is symmetrical, it is not a general case, for example, in the presence of phase shifting transformers the matrix <span>$\mathbf{Y}$</span> is not symmetrical <a href="#refsbranch-1">[1, Sec. 9.6]</a>.</p><hr/><h2 id="injectionpower-1"><a class="docs-heading-anchor" href="#injectionpower-1">Injection Power</a><a class="docs-heading-anchor-permalink" href="#injectionpower-1" title="Permalink"></a></h2><p>The <strong>apparent power injection</strong> <span>$S_i$</span> into the bus <span>$i$</span> is a function of the complex voltage <span>$\bar{V}_i$</span> at the bus <span>$i$</span> and the conjugate value of the injection complex current <span>$\bar{I}_i$</span> into the bus <span>$i$</span>:</p><div>\[  {S}_{i} =\bar{V}_{i}\bar{I}_{i}^* = P_i + \text{j}Q_i,\]</div><p>where <span>$P_i$</span> and <span>$Q_i$</span> represent active power and reactive power injection into the bus <span>$i$</span>. Thus, apparent injection power <span>$S_i$</span> into the bus <span>$i$</span> is:</p><div>\[  {S}_{i} = \bar{V}_{i}\sum\limits_{j \in \mathcal{H}_i} {Y}_{ij}^* \bar{V}_{j}^*,                  \]</div><p>where <span>$\mathcal{H}_i$</span> contains buses incident to the bus <span>$i$</span>, including bus <span>$i$</span>.</p><p>Without loss of generality, we can discard the observed set <span>$\mathcal{H}_i$</span> and observe the entire bus set, where the corresponding elements of the nodal admittance matrix <span>$\mathbf{Y}$</span>  are equal to zero if the buses are not adjacent. Then, using the polar representation for bus voltages, apparent injection power <span>$S_i$</span> is defined:</p><div>\[  {S}_{i} ={V}_{i}\sum\limits_{j = 1}^n {V}_{j} \text{e}^{\text{j}\theta_{ij}}(G_{ij} - \text{j}B_{ij}),   \]</div><p>where <span>$\theta_{ij}=\theta_{i}-\theta_{j}$</span> is the voltage angle difference between buses <span>$i$</span> and <span>$j$</span>. Thus, the <strong>active and reactive injection power</strong> into the bus <span>$i$</span> are equal to:</p><div>\[  \begin{aligned}
    {P}_{i} &amp;={V}_{i}\sum\limits_{j=1}^n {V}_{j}(G_{ij}\cos\theta_{ij} + B_{ij}\sin\theta_{ij})\\
    {Q}_{i} &amp;={V}_{i}\sum\limits_{j=1}^n {V}_{j}(G_{ij}\sin\theta_{ij} - B_{ij}\cos\theta_{ij}).     
	\end{aligned}\]</div><p>These equations represent a hybrid form which is a common form for solving power flow problems <a href="#refsbranch-1">[2]</a>.</p><hr/><h2 id="refsbranch-1"><a class="docs-heading-anchor" href="#refsbranch-1">References</a><a class="docs-heading-anchor-permalink" href="#refsbranch-1" title="Permalink"></a></h2><p>[1] J. Grainger and W. Stevenson, Power system analysis, ser. McGraw-Hill series in electrical and computer engineering: Power and energy. McGraw-Hill, 1994.</p><p>[2] A. Wood and B. Wollenberg, Power Generation, Operation, and Control, ser. A Wiley-Interscience publication. Wiley, 1996.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../generator/">« Measurement Generator</a><a class="docs-footer-nextpage" href="../tbflow/">Power Flow »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 12 June 2020 13:37">Friday 12 June 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

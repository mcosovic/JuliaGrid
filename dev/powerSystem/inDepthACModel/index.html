<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>In-depth AC Model · JuliaGrid</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/tablestyle.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="JuliaGrid logo"/></a><div class="docs-package-name"><span class="docs-autofit">JuliaGrid</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Power System</span><ul><li><a class="tocitem" href="../model/">Power System Model</a></li><li><a class="tocitem" href="../buildModel/">Build Power System Model</a></li><li class="is-active"><a class="tocitem" href>In-depth AC Model</a><ul class="internal"><li><a class="tocitem" href="#branchModelAC"><span>Branch Model</span></a></li><li><a class="tocitem" href="#nodalMatrixAC"><span>System of Equations and Nodal Matrix</span></a></li><li><a class="tocitem" href="#inDepthACModelReference"><span>References</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Power System</a></li><li class="is-active"><a href>In-depth AC Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>In-depth AC Model</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mcosovic/JuliaGrid.jl/blob/master/docs/src/powerSystem/inDepthACModel.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="inDepthACModel"><a class="docs-heading-anchor" href="#inDepthACModel">In-depth AC Model</a><a id="inDepthACModel-1"></a><a class="docs-heading-anchor-permalink" href="#inDepthACModel" title="Permalink"></a></h1><p>Network equations obtained using the unified branch model and defined below represent the basic setup used for the power system analysis. The power system network topology is usually described by the bus/branch model, where branches of the network are defined using the two-port <span>$\pi$</span>-model. The bus/branch model can be represented using a graph <span>$\mathcal{G} = (\mathcal{N}, \mathcal{E})$</span>, where the set of nodes <span>$\mathcal{N} = \{1, \dots, n\}$</span> represents the set of buses, while the set of edges <span>$\mathcal{E} \subseteq \mathcal{N} \times \mathcal{N}$</span> represents the set of branches of the power network.</p><hr/><h2 id="branchModelAC"><a class="docs-heading-anchor" href="#branchModelAC">Branch Model</a><a id="branchModelAC-1"></a><a class="docs-heading-anchor-permalink" href="#branchModelAC" title="Permalink"></a></h2><p>The equivalent unified <span>$\pi$</span>-model for a branch <span>$(i,j) \in \mathcal{E}$</span> incident to the buses <span>$\{i,j\} \in \mathcal{N}$</span> is shown in Figure 2.</p><img src="../../assets/pi_model.png" class="center"/>
<figcaption>Figure 2: The equivalent branch model, where transformer is located at "from bus end" of the branch.</figcaption>
&nbsp;<p>The branch series admittance <span>$y_{ij}$</span> is inversely proportional to the branch series impedance <span>$z_{ij}$</span>:</p><p class="math-container">\[    y_{ij} = \frac{1}{z_{ij}} =
    \frac{1}{{r_{ij}} + \text{j}x_{ij}} =
    \frac{r_{ij}}{r_{ij}^2 + x_{ij}^2} - \text{j}\frac{x_{ij}}{r_{ij}^2 + x_{ij}^2} = g_{ij} + \text{j}b_{ij},\]</p><p>where <span>$r_{ij}$</span> is a resistance, <span>$x_{ij}$</span> is a reactance, <span>$g_{ij}$</span> is a conductance and <span>$b_{ij}$</span> is a susceptance of the branch.</p><pre><code class="language-julia-repl">julia&gt; system.branch.parameter.resistance
ERROR: UndefVarError: system not defined

julia&gt; system.branch.parameter.reactance
ERROR: UndefVarError: system not defined

julia&gt; system.acModel.admittance
ERROR: UndefVarError: system not defined</code></pre><p>The branch shunt capacitive admittance (i.e. charging admittance) <span>$y_{\text{s}ij}$</span> at buses <span>$\{i,j\}$</span> is equal to:</p><p class="math-container">\[y_{\text{s}ij} = \text{j} b_{\text{s}ij}.\]</p><p>Note that JuliaGrid stores the total branch shunt capacitive susceptance <span>$2b_{\text{s}ij}$</span>:</p><pre><code class="language-julia-repl">julia&gt; julia&gt; system.branch.parameter.susceptance
ERROR: UndefVarError: system not defined</code></pre><p>The transformer complex ratio <span>$\alpha_{ij}$</span> is defined:</p><p class="math-container">\[    \alpha_{ij} = \cfrac{1}{\tau_{ij}}e^{-\text{j}\phi_{ij}},\]</p><p>where <span>$\tau_{ij}$</span> is the transformer turns ratio, while <span>$\phi_{ij}$</span> is the transformer phase shift angle, always located &quot;from bus end&quot; of the branch.</p><pre><code class="language-julia-repl">julia&gt; julia&gt; system.branch.parameter.turnsRatio
ERROR: UndefVarError: system not defined

julia&gt; julia&gt; system.branch.parameter.shiftAngle
ERROR: UndefVarError: system not defined

julia&gt; julia&gt; system.acModel.transformerRatio
ERROR: UndefVarError: system not defined</code></pre><p>Using Kirchhoff&#39;s circuit laws, the unified branch model can be described by complex expressions:</p><p class="math-container">\[  \begin{bmatrix}
    \bar{I}_{ij} \\ \bar{I}_{ji}
  \end{bmatrix} =
  \begin{bmatrix}
    \cfrac{1}{\tau_{ij}^2}({y}_{ij} + y_{\text{s}ij}) &amp; -\alpha_{ij}^*{y}_{ij}\\
    -\alpha_{ij}{y}_{ij} &amp; {y}_{ij} + y_{\text{s}ij}
  \end{bmatrix}
  \begin{bmatrix}
    \bar{V}_{i} \\ \bar{V}_{j}
  \end{bmatrix}.\]</p><p>The values of the terms <span>$\left(({y}_{ij} + y_{\text{s}ij}) / \tau_{ij}^2\right)$</span>, <span>$\left(-\alpha_{ij}^*{y}_{ij}\right)$</span>, <span>$\left(-\alpha_{ij}{y}_{ij}\right)$</span>, and <span>$\left({y}_{ij} + y_{\text{s}ij}\right)$</span> can be found stored in four separate arrays, respectively:</p><pre><code class="language-julia-repl">julia&gt; julia&gt; system.acModel.nodalFromFrom
ERROR: UndefVarError: system not defined

julia&gt; julia&gt; system.acModel.nodalFromTo
ERROR: UndefVarError: system not defined

julia&gt; julia&gt; system.acModel.nodalToFrom
ERROR: UndefVarError: system not defined

julia&gt; julia&gt; system.acModel.nodalToTo
ERROR: UndefVarError: system not defined</code></pre><p>Note, if <span>$\tau_{ij} = 1$</span> and <span>$\phi_{ij} = 0$</span> the model describes the line. In-phase transformers are defined if <span>$\phi_{ij} = 0$</span> and <span>$y_{\text{s}ij} = 0$</span>, while phase-shifting transformers are obtained if <span>$y_{\text{s}ij} = 0$</span>.</p><hr/><h2 id="nodalMatrixAC"><a class="docs-heading-anchor" href="#nodalMatrixAC">System of Equations and Nodal Matrix</a><a id="nodalMatrixAC-1"></a><a class="docs-heading-anchor-permalink" href="#nodalMatrixAC" title="Permalink"></a></h2><p>Let us consider an example, given in Figure 3, that will allow us an easy transition to the general case. We observe system with three buses <span>$\mathcal{N} = \{p, k, q\}$</span> and two branches <span>$\mathcal{E} = \{(p, k), (k, q)\}$</span>, where the bus <span>$k$</span> is incident to the shunt element with admittance <span>${y}_{\text{sh}k}$</span>.</p><img src="../../assets/pi_model_example.png" class="center"/>
<figcaption>Figure 3: The example with three buses and two branches.</figcaption>
&nbsp;<p>According to the <a href="#branchModelAC">unified branch model</a> each branch is described using the system of equations as follows:</p><p class="math-container">\[  \begin{bmatrix}
    \bar{I}_{pk} \\ \bar{I}_{kp}
  \end{bmatrix} =
  \begin{bmatrix}
    \cfrac{1}{\tau_{pk}^2}({y}_{pk} + y_{\text{s}pk}) &amp; -\alpha_{pk}^*{y}_{pk}\\
    -\alpha_{pk}{y}_{pk} &amp; {y}_{pk} + y_{\text{s}pk}
  \end{bmatrix}
  \begin{bmatrix}
    \bar{V}_{p} \\ \bar{V}_{k}
  \end{bmatrix}.\]</p><p class="math-container">\[  \begin{bmatrix}
    \bar{I}_{kq} \\ \bar{I}_{qk}
  \end{bmatrix} =
  \begin{bmatrix}
    \cfrac{1}{\tau_{kq}^2}({y}_{kq} + y_{\text{s}kq}) &amp; -\alpha_{kq}^*{y}_{kq}\\
    -\alpha_{kq}{y}_{kq} &amp; {y}_{kq} + y_{\text{s}kq}
  \end{bmatrix}
  \begin{bmatrix}
    \bar{V}_{k} \\ \bar{V}_{q}
  \end{bmatrix}.\]</p><p>The injection complex currents into buses are:</p><p class="math-container">\[  \begin{aligned}
    \bar{I}_{p} &amp;= \bar{I}_{pk} = \cfrac{1}{\tau_{pk}^2}({y}_{pk} + y_{\text{s}pk}) \bar{V}_{p} -\alpha_{kq}^*{y}_{kq} \bar{V}_{k} \\
    \bar{I}_{k} &amp;= \bar{I}_{kp} + \bar{I}_{kq} - \bar{I}_{\text{sh}k} =
    -\alpha_{kq}{y}_{kq} \bar{V}_{p} + ({y}_{kq} + y_{\text{s}kq}) \bar{V}_{k} +
    \cfrac{1}{\tau_{kq}^2}({y}_{kq} + y_{\text{s}kq}) \bar{V}_{k} -\alpha_{kq}^*{y}_{kq} \bar{V}_{q} + {y}_{\text{sh}k} \bar{V}_k \\
    \bar{I}_{q} &amp;= \bar{I}_{qk} = -\alpha_{kq}{y}_{kq} \bar{V}_{k} + ({y}_{kq} + y_{\text{s}kq}) \bar{V}_{q},
  \end{aligned}\]</p><p>The system of equations can be written in the matrix form:</p><p class="math-container">\[  \begin{bmatrix}
    \bar{I}_{p} \\ \bar{I}_{k} \\ \bar{I}_{q}
  \end{bmatrix} =
  \begin{bmatrix}
    \cfrac{1}{\tau_{pk}^2}({y}_{pk} + y_{\text{s}pk}) &amp; -\alpha_{kq}^*{y}_{kq} &amp; 0 \\
   -\alpha_{kq}{y}_{kq} &amp; {y}_{kq} + y_{\text{s}kq} + \cfrac{1}{\tau_{kq}^2}({y}_{kq} + y_{\text{s}kq}) + {y}_{\text{sh}k}  &amp; -\alpha_{kq}^*{y}_{kq} \\
    0 &amp; -\alpha_{kq}{y}_{kq} &amp; {y}_{kq} + y_{\text{s}kq}
  \end{bmatrix}
  \begin{bmatrix}
    \bar{V}_{p} \\ \bar{V}_{k} \\ \bar{V}_{q}
  \end{bmatrix}.\]</p><p>Next, the system of equations for buses <span>$i=1, \dots, n$</span> can be written in the matrix form:</p><p class="math-container">\[  \mathbf {\bar {I}} = \mathbf{Y} \mathbf {\bar {V}},\]</p><p>where <span>$\mathbf {\bar {V}} \in \mathbb{C}^{n}$</span> is the vector of bus complex voltages, and <span>$\mathbf {\bar {I}} \in \mathbb{C}^{n}$</span> is the vector of injection complex currents.</p><p>The matrix <span>$\mathbf{Y} = \mathbf{G} + \text{j}\mathbf{B} \in \mathbb{C}^{n \times n}$</span> is the bus or nodal admittance matrix, with elements:</p><ul><li>the diagonal elements, where <span>$i \in \mathcal{N}$</span>,  are equal to:<p class="math-container">\[Y_{ii} = G_{ii} + \text{j}B_{ii} = {y}_{\text{sh}i} +
\sum\limits_{e \in \mathcal{E}, \; e(1) = i} \cfrac{1}{\tau_{ij}^2}({y}_{ij} + y_{\text{s}ij}) + \sum\limits_{e \in \mathcal{E}, \; e(2) = i} ({y}_{ij} + y_{\text{s}ij}),\]</p></li><li>the non-diagonal elements, where <span>$i = e(1),\;  j = e(2), \; e \in \mathcal{E}$</span>, are equal to:<p class="math-container">\[Y_{ij} = G_{ij} + \text{j}B_{ij} = -\alpha_{ij}^*{y}_{ij}\]</p><p class="math-container">\[Y_{ji} = G_{ji} + \text{j}B_{ji} =  -\alpha_{ij}{y}_{ij}.\]</p></li></ul><p>When a branch is not incident (or adjacent) to a bus the corresponding element in the nodal admittance matrix <span>$\mathbf{Y}$</span> is equal to zero. The nodal admittance matrix <span>$\mathbf{Y}$</span> is a sparse matrix (i.e., a small number of elements are non-zeros) for real-world power systems. Although it is often assumed that the matrix <span>$\mathbf{Y}$</span> is symmetrical, it is not a general case, for example, in the presence of phase shifting transformers the matrix <span>$\mathbf{Y}$</span> is not symmetrical <a href="#inDepthACModelReference">[1, Sec. 9.6]</a>.</p><pre><code class="language-julia-repl">julia&gt; julia&gt; system.acModel.nodalMatrix
ERROR: UndefVarError: system not defined

julia&gt; julia&gt; system.acModel.nodalMatrixTranspose
ERROR: UndefVarError: system not defined</code></pre><hr/><h2 id="inDepthACModelReference"><a class="docs-heading-anchor" href="#inDepthACModelReference">References</a><a id="inDepthACModelReference-1"></a><a class="docs-heading-anchor-permalink" href="#inDepthACModelReference" title="Permalink"></a></h2><p>[1] J. Grainger and W. Stevenson, <em>Power system analysis</em>, ser. McGraw-Hill series in electrical and computer engineering: Power and energy. McGraw-Hill, 1994.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../buildModel/">« Build Power System Model</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 23 November 2022 12:48">Wednesday 23 November 2022</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
